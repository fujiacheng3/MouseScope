/**
 * MouseScope i18n — 中英文切换
 * 使用方式：给元素加 data-i18n="key" 属性，在下方词典中维护对应翻译
 */

const I18N = {
    zh: {
        /* ===== Navbar ===== */
        'nav.home':           '首页',
        'nav.start':          '开始分析',
        'nav.manual':         '使用手册',
        'nav.license':        '许可协议',
        'lang.toggle':        'English',

        /* ===== Footer ===== */
        'footer.rights':      'MouseScope Desktop v1.0 © 2026 All Rights Reserved | 版权所有',
        'footer.academic':    '仅限学术研究使用 · 禁止商业用途 · 禁止二次分发',
        'footer.viewlicense': '查看完整许可协议',

        /* ===== License Modal ===== */
        'license.modal.title':   '用户许可协议 (EULA)',
        'license.modal.warning': '使用本软件前，请仔细阅读以下许可协议：',
        'license.modal.agree':   '我已阅读并同意以上许可协议，承诺仅将本软件用于学术研究目的',
        'license.modal.decline': '不同意并退出',
        'license.modal.accept':  '同意并继续',
        'license.loading':       '加载中...',

        /* ===== Home ===== */
        'home.subtitle':     '基于计算机视觉的智能动物行为分析系统\n专为悬尾实验（TST）设计，自动检测小鼠不动状态',
        'home.version':      'Desktop Edition v1.0 · 学术研究专用',
        'home.btn.start':    '开始分析',
        'home.btn.manual':   '查看手册',

        /* ===== Upload ===== */
        'upload.title':           '视频文件上传',
        'upload.tab.web':         '网页上传',
        'upload.tab.local':       '服务器本地路径',
        'upload.drop.hint':       '拖拽文件到这里',
        'upload.drop.or':         '或点击选择文件',
        'upload.btn.select':      '选择文件',
        'upload.local.tip.title': '提示：',
        'upload.local.tip.body':  '可以直接<strong>拖拽视频文件</strong>到下方区域，或手动输入服务器上的完整路径',
        'upload.local.drag.hint': '拖拽视频文件到这里',
        'upload.local.drag.sub':  '支持 .mp4 .avi .mov .mkv .wmv 格式，可同时拖入多个文件',
        'upload.local.or.select': '或点击选择文件',
        'upload.local.or.input':  '── 或手动输入路径 ──',
        'upload.local.label':     '视频文件/文件夹路径',
        'upload.validate':        '验证路径',
        'upload.uploading':       '上传中...',
        'upload.config.title':    '分析配置',
        'upload.config.start':    '开始秒数（可选）',
        'upload.config.end':      '结束秒数（可选）',
        'upload.config.end.hint': '填写则只分析该时间段',
        'upload.config.outdir':   '输出文件夹（可选）',
        'upload.config.outdir.ph':'留空则使用默认目录: data/results/',
        'upload.config.outdir.hint': '桌面端专属：分析结果将直接保存到此文件夹，可用文件管理器直接查看',
        'upload.config.default':  '默认',
        'upload.config.submit':   '开始分析配置',
        'upload.side.title':      '实验信息',
        'upload.side.tst':        '悬尾实验',
        'upload.side.tst.en':     'Tail Suspension Test',
        'upload.side.tip':        '拍摄要求：',
        'upload.side.tip.body':   '确保小鼠完全悬挂，背景静止，光照均匀',
        'upload.side.flow':       '处理流程',
        'upload.step1':           '1.上传',
        'upload.step2':           '2.标定',
        'upload.step3':           '3.分析',
        'upload.step4':           '4.结果',

        /* ===== Calibrate — Step 1 ===== */
        'calib.step1':            '1. 体长标定',
        'calib.step2':            '2. ROI选择',
        'calib.step3':            '3. 参数调试',
        'calib.instr.p1':         '1. 在画面中选择一只老鼠，点击头部然后点击尾部画一条线',
        'calib.instr.p2':         '2. 系统会根据标准体长(60mm)计算像素-毫米比例',
        'calib.instr.p3':         '如果没有老鼠可以标定，可以直接跳过进入下一步(使用默认比例)',
        'calib.frame.label':      '选择帧:',
        'calib.btn.clear':        '清除重画',
        'calib.btn.confirm':      '确认标定',
        'calib.btn.skip':         '跳过(使用默认)',
        'calib.done.title':       '标定完成',
        'calib.done.pixeldist':   '体长像素距离:',
        'calib.done.ratio':       '标定比例:',

        /* ===== Calibrate — Step 2 ROI ===== */
        'calib.roi.batch.p1':     '1. 批量模式：所有视频将共用同一套 ROI 配置',
        'calib.roi.batch.p2':     '2. 在画面中点击多个点绘制多边形 ROI 区域',
        'calib.roi.batch.p3':     '3. 完成一个 ROI 后点击"完成当前ROI"',
        'calib.roi.batch.p4':     '4. 可以添加多个 ROI（每个对应一只老鼠）',
        'calib.roi.p1':           '1. 在画面中点击多个点绘制多边形 ROI 区域',
        'calib.roi.p2':           '2. 每个 ROI 应该包含一只老鼠（悬挂范围）',
        'calib.roi.p3':           '3. 完成一个 ROI 后点击"完成当前ROI"',
        'calib.roi.p4':           '4. 可以添加多个 ROI（每个对应一只老鼠）',
        'calib.roi.p5':           '5. 全部画完后点击"进入参数调试"',
        'calib.roi.preview.label':'预览视频:',
        'calib.roi.btn.finish':   '完成当前ROI',
        'calib.roi.btn.add':      '添加新ROI',
        'calib.roi.btn.undo':     '撤销一点',
        'calib.roi.btn.clear':    '清除全部',
        'calib.roi.btn.next':     '进入参数调试',
        'calib.roi.list.title':   'ROI 列表',
        'calib.roi.list.empty':   '尚未绘制 ROI',

        /* ===== Calibrate — Step 3 Debug ===== */
        'calib.debug.instr':      '调整检测参数，实时预览效果。确认参数后点击"开始分析"',
        'calib.debug.orig':       '原始帧',
        'calib.debug.result':     '检测结果',
        'calib.debug.method.title':   '检测方法',
        'calib.debug.bg.method.label':'背景减除方法',
        'calib.debug.bg.threshold':   '灰度阈值（推荐）',
        'calib.debug.threshold.label':'灰度阈值',
        'calib.debug.bgtype.label':   '背景类型',
        'calib.debug.bgtype.light':   '浅色背景',
        'calib.debug.bgtype.dark':    '深色背景',
        'calib.debug.morph.title':    '形态学参数',
        'calib.debug.erosion.kernel': '腐蚀核大小',
        'calib.debug.erosion.iter':   '腐蚀迭代次数',
        'calib.debug.dilation.kernel':'膨胀核大小',
        'calib.debug.dilation.iter':  '膨胀迭代次数',
        'calib.debug.min.area':       '最小面积',
        'calib.debug.btn.prev':       '上一步',
        'calib.debug.btn.refresh':    '刷新预览',
        'calib.debug.gen.video':      '生成结果视频',
        'calib.debug.gen.video.hint': '(取消可加速约20%)',
        'calib.debug.btn.start':      '开始分析',

        /* ===== Manual ===== */
        'manual.h1':                  '操作手册',
        'manual.subtitle':            '从视频采集到拿到结果，每一步该怎么做',
        'manual.btn.back':            '返回首页',
        'manual.nav.sec0':            '视频采集要求',
        'manual.nav.sec1':            '上传视频',
        'manual.nav.sec2':            '体长标定',
        'manual.nav.sec3':            '绘制 ROI',
        'manual.nav.sec4':            '参数调试',
        'manual.nav.sec5':            '监控与结果',
        'manual.nav.params':          '参数速查表',
        'manual.sec0.title':          '视频采集要求',
        'manual.sec0.intro':          '分析结果的准确性<strong>完全取决于视频质量</strong>。在录制悬尾实验视频时，请严格遵循以下要求：',
        'manual.sec0.camera.title':   '机位与背景',
        'manual.sec0.camera.li1':     '相机<strong>正对小鼠侧面</strong>拍摄，保持水平，不要有角度倾斜',
        'manual.sec0.camera.li2':     '背景必须<strong>干净、均匀、与小鼠颜色有明显对比</strong>（白色小鼠用深色背景，黑色小鼠用浅色背景）',
        'manual.sec0.camera.li3':     '背景中<strong>不能有其他运动物体</strong>（走动的人、晃动的线缆等）',
        'manual.sec0.camera.li4':     '相机固定在三脚架上，<strong>全程不能移动</strong>',
        'manual.sec0.light.title':    '光照',
        'manual.sec0.light.li1':      '光线<strong>均匀、稳定</strong>，不能忽明忽暗',
        'manual.sec0.light.li2':      '避免强光直射产生高光反射或阴影',
        'manual.sec0.light.li3':      '小鼠身体上不能有大面积的阴影或反光',
        'manual.sec0.rec.title':      '录制参数',
        'manual.sec0.rec.li1':        '格式推荐 MP4 (H.264)，也支持 AVI、MOV、MKV、WMV',
        'manual.sec0.rec.li2':        '如果一个画面中有多只小鼠，确保它们之间<strong>不会互相遮挡</strong>',
        'manual.sec0.examples.title': '实拍示例对比',
        'manual.sec0.good.label':     '正确示例',
        'manual.sec0.good.desc':      '背景干净均匀，小鼠轮廓清晰，光照稳定无阴影，相机水平固定',
        'manual.sec0.bad.label':      '错误示例',
        'manual.sec0.bad.desc':       '距离过近，视角倾斜，相机俯视/仰视',
        'manual.sec0.warning':        '如果视频质量差，后续无论怎么调参数都无法得到准确结果。请在录制阶段就把条件控制好。',
        'manual.sec1.title':          '上传视频',
        'manual.sec1.intro':          '打开首页后，你会看到两种上传方式，选择其中一种即可：',
        'manual.sec1.way1.title':     '方式一：网页上传',
        'manual.sec1.way1.li1':       '点击<strong>"选择文件"</strong>按钮，或者直接把视频文件<strong>拖拽到虚线框</strong>内',
        'manual.sec1.way1.li2':       '可以一次选择多个视频文件，系统会批量处理',
        'manual.sec1.way1.li3':       '选择完成后，下方会显示文件数量和总大小',
        'manual.sec1.way2.title':     '方式二：本地路径',
        'manual.sec1.way2.li1':       '切换到<strong>"服务器本地路径"</strong>标签页',
        'manual.sec1.way2.li2':       '在文本框中输入视频文件或文件夹的<strong>完整路径</strong>，每行一个',
        'manual.sec1.way2.li3':       '如果输入的是文件夹路径，系统会自动扫描里面的所有视频文件',
        'manual.sec1.way2.li4':       '点击<strong>"验证路径"</strong>确认路径有效',
        'manual.sec1.config.title':   '配置项（选填）',
        'manual.sec1.config.li1':     '<strong>开始秒数 / 结束秒数</strong> — 如果你只想分析视频的某一段，就在这里填写。比如视频前 10 秒是准备阶段不需要分析，就在"开始秒数"填 <code>10</code>',
        'manual.sec1.config.li2':     '<strong>输出文件夹</strong> — 指定分析结果保存到哪个文件夹。留空则保存到程序默认目录。填写后结果文件会直接存到你指定的位置，分析完可以直接在文件管理器里打开查看',
        'manual.sec1.submit':         '一切填好后，点击<strong>"开始分析配置"</strong>按钮进入下一步。',
        'manual.sec2.title':          '体长标定（步骤 1/3）',
        'manual.sec2.intro':          '这一步的目的是告诉系统"画面中多少像素等于现实中多少毫米"，这样后续输出的运动速度等数据才有物理单位。',
        'manual.sec2.how.title':      '具体操作',
        'manual.sec2.how.li1':        '拖动画面上方的<strong>帧滑块</strong>，找到一帧能看清某只小鼠完整身体的画面',
        'manual.sec2.how.li2':        '在画面中<strong>点击小鼠的鼻尖</strong>（第一个点，绿色标记）',
        'manual.sec2.how.li3':        '再<strong>点击小鼠的尾根部</strong>（第二个点，红色标记）。两点之间会连一条黄色线段',
        'manual.sec2.how.li4':        '点击<strong>"确认标定"</strong>按钮。系统会按照标准体长自动计算像素-毫米比例',
        'manual.sec2.btns.title':     '操作按钮说明：',
        'manual.sec2.btns.li1':       '<strong>清除重画</strong> — 删掉已经点的标定点，重新来',
        'manual.sec2.btns.li2':       '<strong>确认标定</strong> — 两个点都点好后，点这个按钮完成标定并自动进入下一步',
        'manual.sec2.btns.li3':       '<strong>跳过(使用默认)</strong> — 不标定，使用 1 像素 = 1 毫米的默认比例',
        'manual.sec3.title':          '绘制 ROI 区域（步骤 2/3）',
        'manual.sec3.intro':          'ROI = Region of Interest（感兴趣区域）。你需要<strong>为画面中的每一只小鼠画一个多边形框</strong>，告诉系统在哪个区域里去检测和追踪。',
        'manual.sec3.how.title':      '画 ROI 的方法',
        'manual.sec3.how.li1':        '在画面上<strong>逐点点击</strong>，每点一下就是多边形的一个顶点。把小鼠的活动范围（包括悬挂后摆动的范围）都框进去',
        'manual.sec3.how.li2':        '至少需要 3 个顶点。画好后，<strong>点击"完成当前ROI"</strong>，或者直接<strong>双击画面</strong>也可以完成',
        'manual.sec3.how.li3':        '如果画面中有多只小鼠，点击<strong>"添加新ROI"</strong>按钮，然后重复上述操作画第二个、第三个……',
        'manual.sec3.shortcut.title': '快捷操作',
        'manual.sec3.shortcut.li1':   '<strong>双击画面</strong> — 直接完成当前 ROI（等同于点"完成当前ROI"按钮）',
        'manual.sec3.shortcut.li2':   '<strong>右键点击画面</strong> — 撤销最后一个点（等同于点"撤销一点"按钮）',
        'manual.sec3.shortcut.li3':   '拖动<strong>帧滑块</strong>可以切换到不同帧查看，确保 ROI 框住了小鼠的整个活动范围',
        'manual.sec3.indiv.title':    'ROI 单独设置',
        'manual.sec3.indiv.p':        '每个 ROI 右侧有一个 <i class="fas fa-cog text-info"></i> 齿轮按钮，点击展开设置面板：',
        'manual.sec3.indiv.li.name':  '<strong>ROI 名称</strong> — 给这个区域起个名字（比如"1号鼠"、"对照组"），方便后续看结果时区分',
        'manual.sec3.indiv.time':     '<strong>时间控制模式</strong>：',
        'manual.sec3.indiv.t1':       '<strong>跟随全局设置</strong>（默认） — 使用你在上传页面填的开始/结束时间',
        'manual.sec3.indiv.t2':       '<strong>相对检测时间</strong> — 以系统首次检测到这只老鼠的时刻作为起点计时。比如开始填 <code>0</code>，结束填 <code>300</code>，意思是"从检测到老鼠那一刻起，分析 300 秒"',
        'manual.sec3.indiv.t3':       '<strong>精确时间段</strong> — 填视频的绝对时间。比如开始 <code>60</code>，结束 <code>360</code>，意思是"只分析视频第 1 分钟到第 6 分钟"',
        'manual.sec3.btns.title':     '操作按钮说明：',
        'manual.sec3.btns.li1':       '<strong>完成当前ROI</strong> — 将正在画的多边形封闭，添加到列表',
        'manual.sec3.btns.li2':       '<strong>添加新ROI</strong> — 开始画下一个 ROI',
        'manual.sec3.btns.li3':       '<strong>撤销一点</strong> — 删掉最后点的那个顶点',
        'manual.sec3.btns.li4':       '<strong>清除全部</strong> — 删掉所有已画好的 ROI，从头来',
        'manual.sec3.btns.li5':       '<strong>进入参数调试</strong> — ROI 全部画完后点这个，进入下一步',
        'manual.sec3.warning':        'ROI 一定要画得<strong>足够大</strong>，把小鼠挣扎时可能摆动到的范围都包进去。如果 ROI 太小，小鼠身体的一部分会跑到框外面，导致检测丢失。',
        'manual.sec4.title':          '参数调试（步骤 3/3）',
        'manual.sec4.intro':          '这一步可以<strong>实时预览检测效果</strong>。左边显示原始画面，右边显示检测结果（绿色轮廓和圆点就是系统找到的小鼠）。调整参数后，预览会自动刷新。',
        'manual.sec4.goal':           '你的目标是：调到右边的绿色轮廓刚好覆盖住小鼠身体、没有多余的噪点',
        'manual.sec4.method.title':   '检测方法（灰度阈值）',
        'manual.sec4.method.th.opt':  '选项',
        'manual.sec4.method.th.desc': '说明',
        'manual.sec4.method.td.name': '灰度阈值',
        'manual.sec4.method.td.desc': '本系统仅支持灰度阈值分割，请确保视频质量良好，需要配合下方的"灰度阈值"滑块和"背景类型"选项进行调节。',
        'manual.sec4.thresh.title':   '灰度阈值 + 背景类型（仅"灰度阈值"方法时有效）',
        'manual.sec4.thresh.li.bgtype':'<strong>背景类型</strong> — 先确认你的背景是浅色还是深色，选对这个',
        'manual.sec4.thresh.li.th':   '<strong>灰度阈值</strong>（0–255）— 这个滑块控制"多深/多浅的像素算作小鼠"：',
        'manual.sec4.thresh.li.th1':  '拖动滑块，看右侧预览中小鼠的轮廓是否完整',
        'manual.sec4.thresh.li.th2':  '如果检测不到小鼠 → 往让检测更灵敏的方向调（浅色背景时往右拖，深色背景时往左拖）',
        'manual.sec4.thresh.li.th3':  '如果把背景也误检出来了 → 往反方向调',
        'manual.sec4.thresh.li.th4':  '调到<strong>恰好把小鼠完整地框出来，同时背景上没有杂散噪点</strong>就对了',
        'manual.sec4.morph.title':    '形态学参数',
        'manual.sec4.morph.p':        '这些参数用来"清理"检测结果，去掉噪点、把断裂的轮廓连起来：',
        'manual.sec4.morph.th.param': '参数',
        'manual.sec4.morph.th.big':   '往大调的效果',
        'manual.sec4.morph.th.small': '往小调的效果',
        'manual.sec4.morph.ek.big':   '更多小噪点被消除，但小鼠轮廓也会缩小',
        'manual.sec4.morph.ek.small': '保留更多细节，但噪点也会保留',
        'manual.sec4.morph.ei.big':   '腐蚀效果更强（多执行几轮）',
        'manual.sec4.morph.ei.small': '设为 0 就不腐蚀',
        'manual.sec4.morph.dk.big':   '轮廓膨胀得更多，断裂的部分更容易连起来',
        'manual.sec4.morph.dk.small': '膨胀效果弱，轮廓更贴合实际',
        'manual.sec4.morph.di.big':   '膨胀效果更强（多执行几轮）',
        'manual.sec4.morph.di.small': '设为 0 就不膨胀',
        'manual.sec4.morph.ma.big':   '面积小于此值的检测结果会被丢弃——能过滤噪点，但如果设太大会把小鼠也丢掉',
        'manual.sec4.morph.ma.small': '更小的目标也会被保留，可能会把噪点也当成检测结果',
        'manual.sec4.flow.title':     '调参流程',
        'manual.sec4.flow.li1':       '先拖<strong>帧滑块</strong>选几个不同的帧（小鼠不同姿态下），看检测效果是否稳定',
        'manual.sec4.flow.li2':       '如果检测不到小鼠 → 先调<strong>灰度阈值</strong>和<strong>背景类型</strong>',
        'manual.sec4.flow.li3':       '如果轮廓有很多噪点 → 增大<strong>腐蚀</strong>参数 或 增大<strong>最小面积</strong>',
        'manual.sec4.flow.li4':       '如果小鼠轮廓断裂不完整 → 增大<strong>膨胀</strong>参数',
        'manual.sec4.flow.li5':       '在不同帧上反复检查，直到大部分帧都能干净地检测到小鼠',
        'manual.sec4.other.title':    '其他选项',
        'manual.sec4.other.li1':      '<strong>生成结果视频</strong> — 默认勾选。会输出一个带有追踪标记的视频文件。如果你不需要看视频只要数据，取消勾选可以加快处理速度',
        'manual.sec4.submit':         '一切就绪后，点击右下角的<strong>"开始分析"</strong>按钮，系统开始处理。',
        'manual.sec5.title':          '监控分析进度 & 查看结果',
        'manual.sec5.intro':          '点击"开始分析"后会自动跳转到监控页面。',
        'manual.sec5.monitor.title':  '监控页面内容',
        'manual.sec5.monitor.li1':    '<strong>处理状态</strong> — 当前状态（分析中 / 已完成 / 出错）和进度百分比',
        'manual.sec5.monitor.li2':    '<strong>性能指标</strong> — 已处理多少帧、运行了多长时间、处理速度（fps）',
        'manual.sec5.monitor.li3':    '<strong>实时数据</strong> — 每个 ROI 区域的小鼠当前是"挣扎"还是"静止"，以及光流数值',
        'manual.sec5.monitor.li4':    '<strong>系统日志</strong> — 仿终端界面，显示处理过程中的详细信息',
        'manual.sec5.done.title':     '分析完成后',
        'manual.sec5.done.p':         '分析完成后，下载区域会自动出现，有两种方式获取结果：',
        'manual.sec5.done.li1':       '<strong>打开结果文件夹</strong>（推荐）— 点击这个按钮，系统会用文件管理器直接打开结果所在的文件夹，你可以直接查看、复制文件',
        'manual.sec5.done.li2':       '<strong>网页下载</strong> — 点击"全部下载 (ZIP)"打包下载所有文件，或者通过下拉菜单单独下载某个文件',
        'manual.sec5.files.title':    '输出文件说明',
        'manual.sec5.files.th.file':  '文件',
        'manual.sec5.files.th.desc':  '内容',
        'manual.sec5.files.mp4':      '带追踪标记的视频。可以看到每只小鼠的检测轮廓、质心位置和当前行为状态标注',
        'manual.sec5.files.logs':     '逐帧数据日志。每一行是一帧的数据，包括帧号、时间、ROI 编号、是否挣扎、光流值等',
        'manual.sec5.files.imm':      '统计汇总表。每只小鼠一行，包括总时长、不动时间、不动比例、挣扎时间、挣扎比例、首次不动潜伏期等',
        'manual.sec5.files.txt':      '纯文本报告，内容和上面的 CSV 一样，方便直接阅读',
        'manual.sec5.tip':            '如果分析中途发现参数不对，可以点<strong>"停止分析"</strong>按钮终止，然后回到首页重新上传操作。',
        'manual.params.title':        '参数速查表',
        'manual.params.th.param':     '参数',
        'manual.params.th.range':     '范围',
        'manual.params.th.tip':       '拿不准的时候怎么做',
        'manual.params.gray.tip':     '一边拖滑块一边看右侧预览，调到小鼠刚好被完整检出、背景干净为止',
        'manual.params.bgtype.range': '浅色 / 深色',
        'manual.params.bgtype.tip':   '肉眼看画面背景是什么颜色就选什么',
        'manual.params.ek.tip':       '背景有很多小白点噪点 → 调大；小鼠轮廓变残缺了 → 调小',
        'manual.params.ei.tip':       '噪点太多去不掉 → 增加次数；小鼠要消失了 → 减少次数',
        'manual.params.dk.tip':       '小鼠轮廓断裂有缺口 → 调大；多只鼠的检测框连到一起了 → 调小',
        'manual.params.di.tip':       '缺口还是补不上 → 增加次数；框膨胀太大了 → 减少次数',
        'manual.params.ma.tip':       '有零散噪点被当成老鼠 → 调大；真正的老鼠被过滤掉了 → 调小',
        'manual.params.tip':          '<strong>核心技巧：</strong>每改一个参数就看一眼右侧预览。在多个不同帧上检查效果（拖帧滑块），确保不只是某一帧好用，而是大部分帧都行。',
        'manual.disclaimer.title':    '免责声明',
        'manual.disclaimer.p':        '本系统提供的分析结果仅供参考。由于光照条件、视频质量、动物个体差异等因素的影响，结果可能存在误差。<strong>请研究人员务必对结果进行人工核查。</strong>系统作者不对因使用本系统而导致的数据偏差承担责任。',
        'manual.disclaimer.academic': '仅供学术交流，禁止商业用途',
        'manual.disclaimer.author':   '作者：付家丞 (Jiacheng Fu)',
        'manual.disclaimer.email':    'Email: 2583348593@qq.com',
        'manual.disclaimer.org':      '中国科学院生物物理研究所 (IBP, CAS)',

        /* ===== License Page ===== */
        'license.page.title':        '用户许可协议 (EULA)',
        'license.page.warning':      '重要提示：本软件仅限学术研究使用，严禁用于任何商业目的，严禁二次分发。',
        'license.page.card1.title':  '学术研究 ✓',
        'license.page.card1.desc':   '可免费用于科研和教学',
        'license.page.card2.title':  '商业使用 ✗',
        'license.page.card2.desc':   '禁止出售、出租或有偿服务',
        'license.page.card3.title':  '二次分发 ✗',
        'license.page.card3.desc':   '禁止上传到公共平台传播',

        /* ===== Monitor ===== */
        'monitor.title':          '实时分析监控',
        'monitor.subtitle':       '实时追踪分析进度与性能指标',
        'monitor.stop':           '停止分析',
        'monitor.refresh':        '刷新',
        'monitor.status.title':   '处理状态',
        'monitor.status.loading': '加载中...',
        'monitor.status.label':   '分析状态',
        'monitor.progress.label': '完成进度',
        'monitor.engine':         '处理状态',
        'monitor.waiting':        '等待引擎响应...',
        'monitor.download.title': '下载结果文件',
        'monitor.dl.all':         '全部下载 (ZIP)',
        'monitor.dl.single':      '单独下载',
        'monitor.dl.video':       '分析视频',
        'monitor.dl.csv':         '详细日志 CSV',
        'monitor.dl.immcsv':      '统计数据 CSV',
        'monitor.dl.report':      '报告 TXT',
        'monitor.open.folder':    '打开结果文件夹',
        'monitor.path.label':     '结果保存位置：',
        'monitor.file.desc':      '文件说明：ZIP包含分析视频、帧数据CSV、不动时间CSV和文字报告。桌面端可直接点击"打开结果文件夹"在文件管理器中查看。',
        'monitor.perf.title':     '性能指标',

        /* ===== Manual ===== */
        'manual.title':           '操作手册 - MouseScope',
    },

    en: {
        /* ===== Navbar ===== */
        'nav.home':           'Home',
        'nav.start':          'Start Analysis',
        'nav.manual':         'User Manual',
        'nav.license':        'License',
        'lang.toggle':        '中文',

        /* ===== Footer ===== */
        'footer.rights':      'MouseScope Desktop v1.0 © 2026 All Rights Reserved',
        'footer.academic':    'For Academic Research Only · No Commercial Use · No Redistribution',
        'footer.viewlicense': 'View Full License',

        /* ===== License Modal ===== */
        'license.modal.title':   'End User License Agreement (EULA)',
        'license.modal.warning': 'Please read the following license agreement carefully before using this software:',
        'license.modal.agree':   'I have read and agree to the license agreement, and commit to using this software for academic research purposes only.',
        'license.modal.decline': 'Decline & Exit',
        'license.modal.accept':  'Accept & Continue',
        'license.loading':       'Loading...',

        /* ===== Home ===== */
        'home.subtitle':     'AI-powered animal behavior analysis system\nDesigned for Tail Suspension Test (TST), auto-detects mouse immobility',
        'home.version':      'Desktop Edition v1.0 · Academic Research Only',
        'home.btn.start':    'Start Analysis',
        'home.btn.manual':   'User Manual',

        /* ===== Upload ===== */
        'upload.title':           'Upload Video Files',
        'upload.tab.web':         'Web Upload',
        'upload.tab.local':       'Server Local Path',
        'upload.drop.hint':       'Drag & drop files here',
        'upload.drop.or':         'or click to select',
        'upload.btn.select':      'Select Files',
        'upload.local.tip.title': 'Tip:',
        'upload.local.tip.body':  'Drag <strong>video files</strong> to the area below, or manually type the full server path.',
        'upload.local.drag.hint': 'Drag video files here',
        'upload.local.drag.sub':  'Supports .mp4 .avi .mov .mkv .wmv, multiple files allowed',
        'upload.local.or.select': 'Or click to select files',
        'upload.local.or.input':  '── or enter path manually ──',
        'upload.local.label':     'Video file / folder path',
        'upload.validate':        'Validate Paths',
        'upload.uploading':       'Uploading...',
        'upload.config.title':    'Analysis Configuration',
        'upload.config.start':    'Start time (optional)',
        'upload.config.end':      'End time (optional)',
        'upload.config.end.hint': 'If set, only this time range will be analyzed',
        'upload.config.outdir':   'Output folder (optional)',
        'upload.config.outdir.ph':'Leave blank to use default: data/results/',
        'upload.config.outdir.hint': 'Desktop exclusive: results are saved directly to this folder',
        'upload.config.default':  'Default',
        'upload.config.submit':   'Proceed to Configuration',
        'upload.side.title':      'Experiment Info',
        'upload.side.tst':        'Tail Suspension Test',
        'upload.side.tst.en':     'TST',
        'upload.side.tip':        'Recording Requirements:',
        'upload.side.tip.body':   'Ensure the mouse is fully suspended, background is static, and lighting is uniform.',
        'upload.side.flow':       'Processing Pipeline',
        'upload.step1':           '1.Upload',
        'upload.step2':           '2.Calibrate',
        'upload.step3':           '3.Analyze',
        'upload.step4':           '4.Results',

        /* ===== Calibrate — Step 1 ===== */
        'calib.step1':            '1. Body Length Calibration',
        'calib.step2':            '2. ROI Selection',
        'calib.step3':            '3. Parameter Tuning',
        'calib.instr.p1':         '1. Select a mouse in the frame, click the head then the tail to draw a line.',
        'calib.instr.p2':         '2. The system calculates the pixel-to-mm ratio based on standard body length (60 mm).',
        'calib.instr.p3':         'If no mouse is visible, skip this step to use the default ratio.',
        'calib.frame.label':      'Select Frame:',
        'calib.btn.clear':        'Clear & Redraw',
        'calib.btn.confirm':      'Confirm Calibration',
        'calib.btn.skip':         'Skip (Use Default)',
        'calib.done.title':       'Calibration Complete',
        'calib.done.pixeldist':   'Body Length (pixels):',
        'calib.done.ratio':       'Calibration Ratio:',

        /* ===== Calibrate — Step 2 ROI ===== */
        'calib.roi.batch.p1':     '1. Batch mode: all videos will share the same ROI configuration.',
        'calib.roi.batch.p2':     '2. Click multiple points in the image to draw a polygon ROI.',
        'calib.roi.batch.p3':     '3. Click "Finish Current ROI" when done.',
        'calib.roi.batch.p4':     '4. Add multiple ROIs (one per mouse).',
        'calib.roi.p1':           '1. Click multiple points in the image to draw a polygon ROI.',
        'calib.roi.p2':           '2. Each ROI should contain one mouse (covering its swing range).',
        'calib.roi.p3':           '3. Click "Finish Current ROI" when done.',
        'calib.roi.p4':           '4. Add multiple ROIs (one per mouse).',
        'calib.roi.p5':           '5. Click "Go to Parameter Tuning" when all ROIs are drawn.',
        'calib.roi.preview.label':'Preview Video:',
        'calib.roi.btn.finish':   'Finish Current ROI',
        'calib.roi.btn.add':      'Add New ROI',
        'calib.roi.btn.undo':     'Undo Last Point',
        'calib.roi.btn.clear':    'Clear All',
        'calib.roi.btn.next':     'Go to Parameter Tuning',
        'calib.roi.list.title':   'ROI List',
        'calib.roi.list.empty':   'No ROI drawn yet',

        /* ===== Calibrate — Step 3 Debug ===== */
        'calib.debug.instr':           'Adjust detection parameters and preview the result in real time. Click "Start Analysis" when satisfied.',
        'calib.debug.orig':            'Original Frame',
        'calib.debug.result':          'Detection Result',
        'calib.debug.method.title':    'Detection Method',
        'calib.debug.bg.method.label': 'Background Subtraction Method',
        'calib.debug.bg.threshold':    'Grayscale Threshold (Recommended)',
        'calib.debug.threshold.label': 'Grayscale Threshold',
        'calib.debug.bgtype.label':    'Background Type',
        'calib.debug.bgtype.light':    'Light Background',
        'calib.debug.bgtype.dark':     'Dark Background',
        'calib.debug.morph.title':     'Morphology Parameters',
        'calib.debug.erosion.kernel':  'Erosion Kernel Size',
        'calib.debug.erosion.iter':    'Erosion Iterations',
        'calib.debug.dilation.kernel': 'Dilation Kernel Size',
        'calib.debug.dilation.iter':   'Dilation Iterations',
        'calib.debug.min.area':        'Minimum Area',
        'calib.debug.btn.prev':        'Previous Step',
        'calib.debug.btn.refresh':     'Refresh Preview',
        'calib.debug.gen.video':       'Generate Result Video',
        'calib.debug.gen.video.hint':  '(Uncheck to speed up ~20%)',
        'calib.debug.btn.start':       'Start Analysis',

        /* ===== License Page ===== */
        'license.page.title':        'End User License Agreement (EULA)',
        'license.page.warning':      'Important: This software is for academic research only. Commercial use and redistribution are strictly prohibited.',
        'license.page.card1.title':  'Academic Research ✓',
        'license.page.card1.desc':   'Free to use for research and education',
        'license.page.card2.title':  'Commercial Use ✗',
        'license.page.card2.desc':   'Sale, rental, or paid services prohibited',
        'license.page.card3.title':  'Redistribution ✗',
        'license.page.card3.desc':   'Uploading to public platforms prohibited',

        /* ===== Monitor ===== */
        'monitor.title':          'Live Analysis Monitor',
        'monitor.subtitle':       'Real-time progress & performance tracking',
        'monitor.stop':           'Stop Analysis',
        'monitor.refresh':        'Refresh',
        'monitor.status.title':   'Processing Status',
        'monitor.status.loading': 'Loading...',
        'monitor.status.label':   'Analysis Status',
        'monitor.progress.label': 'Progress',
        'monitor.engine':         'Processing Status',
        'monitor.waiting':        'Waiting for engine response...',
        'monitor.download.title': 'Download Result Files',
        'monitor.dl.all':         'Download All (ZIP)',
        'monitor.dl.single':      'Download Single',
        'monitor.dl.video':       'Analysis Video',
        'monitor.dl.csv':         'Detailed Log CSV',
        'monitor.dl.immcsv':      'Statistics CSV',
        'monitor.dl.report':      'Report TXT',
        'monitor.open.folder':    'Open Result Folder',
        'monitor.path.label':     'Results saved at:',
        'monitor.file.desc':      'The ZIP contains the analysis video, frame-level CSV, immobility CSV and text report. Desktop users can click "Open Result Folder" to view in file manager.',
        'monitor.perf.title':     'Performance Metrics',

        /* ===== Manual ===== */
        'manual.h1':                  'User Manual',
        'manual.subtitle':            'Step-by-step guide from video recording to final results',
        'manual.btn.back':            'Back to Home',
        'manual.nav.sec0':            'Video Requirements',
        'manual.nav.sec1':            'Upload Video',
        'manual.nav.sec2':            'Body Length Calibration',
        'manual.nav.sec3':            'Draw ROI',
        'manual.nav.sec4':            'Parameter Tuning',
        'manual.nav.sec5':            'Monitor & Results',
        'manual.nav.params':          'Parameter Reference',
        'manual.sec0.title':          'Video Recording Requirements',
        'manual.sec0.intro':          'Analysis accuracy <strong>depends entirely on video quality</strong>. Please strictly follow these requirements when recording:',
        'manual.sec0.camera.title':   'Camera Position & Background',
        'manual.sec0.camera.li1':     'Camera should face the mouse <strong>from the side</strong>, kept horizontal with no tilt.',
        'manual.sec0.camera.li2':     'Background must be <strong>clean, uniform, and contrast clearly with the mouse</strong> (dark background for white mice; light background for black mice).',
        'manual.sec0.camera.li3':     'The background must <strong>not contain any moving objects</strong> (people walking, swinging cables, etc.).',
        'manual.sec0.camera.li4':     'Camera must be mounted on a tripod and <strong>must not move at all</strong> during recording.',
        'manual.sec0.light.title':    'Lighting',
        'manual.sec0.light.li1':      'Lighting should be <strong>uniform and stable</strong> — no flickering.',
        'manual.sec0.light.li2':      'Avoid direct strong light that causes specular highlights or shadows.',
        'manual.sec0.light.li3':      'The mouse body should not have large shadow areas or reflections.',
        'manual.sec0.rec.title':      'Recording Parameters',
        'manual.sec0.rec.li1':        'Recommended format: MP4 (H.264). AVI, MOV, MKV, WMV are also supported.',
        'manual.sec0.rec.li2':        'If multiple mice appear in one frame, ensure they <strong>do not occlude each other</strong>.',
        'manual.sec0.examples.title': 'Example Comparison',
        'manual.sec0.good.label':     'Correct Example',
        'manual.sec0.good.desc':      'Clean uniform background, clear mouse silhouette, stable lighting without shadows, camera fixed horizontally.',
        'manual.sec0.bad.label':      'Incorrect Example',
        'manual.sec0.bad.desc':       'Too close, tilted angle, camera looking down / up.',
        'manual.sec0.warning':        'Poor video quality cannot be compensated by parameter tuning. Get the conditions right at the recording stage.',
        'manual.sec1.title':          'Upload Video',
        'manual.sec1.intro':          'On the home page you will see two upload methods — choose one:',
        'manual.sec1.way1.title':     'Method 1: Web Upload',
        'manual.sec1.way1.li1':       'Click the <strong>"Select Files"</strong> button, or drag video files directly into the dashed box.',
        'manual.sec1.way1.li2':       'You can select multiple video files at once; they will be processed in batch.',
        'manual.sec1.way1.li3':       'After selection, the file count and total size will be shown below.',
        'manual.sec1.way2.title':     'Method 2: Local Path',
        'manual.sec1.way2.li1':       'Switch to the <strong>"Server Local Path"</strong> tab.',
        'manual.sec1.way2.li2':       'Enter the <strong>full path</strong> of the video file or folder, one per line.',
        'manual.sec1.way2.li3':       'If a folder path is entered, all video files inside will be scanned automatically.',
        'manual.sec1.way2.li4':       'Click <strong>"Validate Paths"</strong> to confirm the paths are valid.',
        'manual.sec1.config.title':   'Configuration (Optional)',
        'manual.sec1.config.li1':     '<strong>Start / End time (seconds)</strong> — Fill in if you only want to analyze a specific segment. For example, if the first 10 seconds are preparation, enter <code>10</code> in "Start time".',
        'manual.sec1.config.li2':     '<strong>Output folder</strong> — Specify where results should be saved. Leave blank to use the default directory. Results will be saved there directly and can be opened in the file manager.',
        'manual.sec1.submit':         'When everything is set, click the <strong>"Proceed to Configuration"</strong> button.',
        'manual.sec2.title':          'Body Length Calibration (Step 1/3)',
        'manual.sec2.intro':          'This step tells the system "how many pixels equal how many millimetres in the frame", so that movement speed and other metrics have physical units.',
        'manual.sec2.how.title':      'How to Do It',
        'manual.sec2.how.li1':        'Drag the <strong>frame slider</strong> to find a frame where one mouse\'s full body is clearly visible.',
        'manual.sec2.how.li2':        '<strong>Click the mouse\'s nose tip</strong> (first point — green marker).',
        'manual.sec2.how.li3':        'Then <strong>click the base of the tail</strong> (second point — red marker). A yellow line connects the two points.',
        'manual.sec2.how.li4':        'Click <strong>"Confirm Calibration"</strong>. The system computes the pixel-to-mm ratio from the standard body length.',
        'manual.sec2.btns.title':     'Button Reference:',
        'manual.sec2.btns.li1':       '<strong>Clear & Redraw</strong> — Remove calibration points and start over.',
        'manual.sec2.btns.li2':       '<strong>Confirm Calibration</strong> — After placing both points, click this to finish and advance.',
        'manual.sec2.btns.li3':       '<strong>Skip (Use Default)</strong> — Skip calibration and use the default ratio of 1 pixel = 1 mm.',
        'manual.sec3.title':          'Draw ROI Region (Step 2/3)',
        'manual.sec3.intro':          'ROI = Region of Interest. You need to <strong>draw a polygon around each mouse</strong> to tell the system where to detect and track.',
        'manual.sec3.how.title':      'How to Draw an ROI',
        'manual.sec3.how.li1':        '<strong>Click point by point</strong> in the frame — each click adds a vertex of the polygon. Cover the entire range the mouse might swing to.',
        'manual.sec3.how.li2':        'At least 3 vertices are required. Then click <strong>"Finish Current ROI"</strong> or <strong>double-click the canvas</strong> to close the polygon.',
        'manual.sec3.how.li3':        'If there are multiple mice, click <strong>"Add New ROI"</strong> and repeat for each one.',
        'manual.sec3.shortcut.title': 'Shortcuts',
        'manual.sec3.shortcut.li1':   '<strong>Double-click canvas</strong> — Finish current ROI (same as the button).',
        'manual.sec3.shortcut.li2':   '<strong>Right-click canvas</strong> — Undo the last point.',
        'manual.sec3.shortcut.li3':   'Drag the <strong>frame slider</strong> to check different frames and make sure the ROI covers the full activity range.',
        'manual.sec3.indiv.title':    'Per-ROI Settings',
        'manual.sec3.indiv.p':        'Each ROI has a <i class="fas fa-cog text-info"></i> gear button on the right. Click it to expand the settings panel:',
        'manual.sec3.indiv.li.name':  '<strong>ROI Name</strong> — Give this region a name (e.g. "Mouse 1", "Control Group") for easy identification in results.',
        'manual.sec3.indiv.time':     '<strong>Time Control Mode:</strong>',
        'manual.sec3.indiv.t1':       '<strong>Follow Global Settings</strong> (default) — Uses the start/end time filled in on the upload page.',
        'manual.sec3.indiv.t2':       '<strong>Relative Detection Time</strong> — Counts from the moment the mouse is first detected. E.g. start <code>0</code>, end <code>300</code> means "analyze for 300 s starting from first detection".',
        'manual.sec3.indiv.t3':       '<strong>Precise Time Range</strong> — Uses absolute video time. E.g. start <code>60</code>, end <code>360</code> means "analyze from 1 min to 6 min".',
        'manual.sec3.btns.title':     'Button Reference:',
        'manual.sec3.btns.li1':       '<strong>Finish Current ROI</strong> — Close the polygon and add it to the list.',
        'manual.sec3.btns.li2':       '<strong>Add New ROI</strong> — Start drawing the next ROI.',
        'manual.sec3.btns.li3':       '<strong>Undo Last Point</strong> — Remove the last vertex added.',
        'manual.sec3.btns.li4':       '<strong>Clear All</strong> — Delete all ROIs and start over.',
        'manual.sec3.btns.li5':       '<strong>Go to Parameter Tuning</strong> — Proceed after all ROIs are drawn.',
        'manual.sec3.warning':        'Draw the ROI <strong>large enough</strong> to cover the full swing range. If the ROI is too small, part of the mouse body will fall outside and detection will be lost.',
        'manual.sec4.title':          'Parameter Tuning (Step 3/3)',
        'manual.sec4.intro':          'This step lets you <strong>preview detection results in real time</strong>. The left panel shows the original frame; the right shows the detection result (green contours and dots = detected mouse). Adjust parameters and the preview updates automatically.',
        'manual.sec4.goal':           'Your goal: adjust until the green contour covers exactly the mouse body with no spurious noise.',
        'manual.sec4.method.title':   'Detection Method (Grayscale Threshold)',
        'manual.sec4.method.th.opt':  'Option',
        'manual.sec4.method.th.desc': 'Description',
        'manual.sec4.method.td.name': 'Grayscale Threshold',
        'manual.sec4.method.td.desc': 'The only supported method. Ensure good video quality. Adjust the threshold slider and background type below.',
        'manual.sec4.thresh.title':   'Grayscale Threshold + Background Type',
        'manual.sec4.thresh.li.bgtype':'<strong>Background Type</strong> — Select whether your background is light or dark.',
        'manual.sec4.thresh.li.th':   '<strong>Grayscale Threshold</strong> (0–255) — Controls which pixel brightness counts as "mouse":',
        'manual.sec4.thresh.li.th1':  'Drag the slider and watch the right-side preview for a complete mouse contour.',
        'manual.sec4.thresh.li.th2':  'Mouse not detected → drag toward more sensitive (right for light BG, left for dark BG).',
        'manual.sec4.thresh.li.th3':  'Background falsely detected → drag in the opposite direction.',
        'manual.sec4.thresh.li.th4':  'Stop when <strong>the mouse is cleanly outlined with no background noise</strong>.',
        'manual.sec4.morph.title':    'Morphology Parameters',
        'manual.sec4.morph.p':        'These parameters "clean up" the detection mask — removing noise and connecting broken contours:',
        'manual.sec4.morph.th.param': 'Parameter',
        'manual.sec4.morph.th.big':   'Effect of increasing',
        'manual.sec4.morph.th.small': 'Effect of decreasing',
        'manual.sec4.morph.ek.big':   'More small noise removed, but mouse contour shrinks',
        'manual.sec4.morph.ek.small': 'More detail preserved, but noise is also kept',
        'manual.sec4.morph.ei.big':   'Stronger erosion (more iterations)',
        'manual.sec4.morph.ei.small': 'Set to 0 to disable erosion',
        'manual.sec4.morph.dk.big':   'Contour expands more, easier to bridge gaps',
        'manual.sec4.morph.dk.small': 'Weaker dilation, contour stays closer to actual shape',
        'manual.sec4.morph.di.big':   'Stronger dilation (more iterations)',
        'manual.sec4.morph.di.small': 'Set to 0 to disable dilation',
        'manual.sec4.morph.ma.big':   'Detections smaller than this are discarded — filters noise, but too large may discard the mouse',
        'manual.sec4.morph.ma.small': 'Smaller targets are kept — may retain noise as detections',
        'manual.sec4.flow.title':     'Tuning Workflow',
        'manual.sec4.flow.li1':       'Drag the <strong>frame slider</strong> to a few different frames (different mouse poses) to check stability.',
        'manual.sec4.flow.li2':       'Mouse not detected → start with <strong>Grayscale Threshold</strong> and <strong>Background Type</strong>.',
        'manual.sec4.flow.li3':       'Lots of noise contours → increase <strong>Erosion</strong> parameters or increase <strong>Minimum Area</strong>.',
        'manual.sec4.flow.li4':       'Mouse contour is broken / incomplete → increase <strong>Dilation</strong> parameters.',
        'manual.sec4.flow.li5':       'Check repeatedly on different frames until most frames produce clean detections.',
        'manual.sec4.other.title':    'Other Options',
        'manual.sec4.other.li1':      '<strong>Generate Result Video</strong> — Checked by default. Outputs a video with tracking overlays. Uncheck if you only need the data — it speeds up processing.',
        'manual.sec4.submit':         'When ready, click the <strong>"Start Analysis"</strong> button in the bottom-right corner.',
        'manual.sec5.title':          'Monitor Progress & View Results',
        'manual.sec5.intro':          'After clicking "Start Analysis", you will be redirected to the monitor page automatically.',
        'manual.sec5.monitor.title':  'Monitor Page Contents',
        'manual.sec5.monitor.li1':    '<strong>Processing Status</strong> — Current state (Analyzing / Completed / Error) and progress percentage.',
        'manual.sec5.monitor.li2':    '<strong>Performance Metrics</strong> — Frames processed, elapsed time, processing speed (fps).',
        'manual.sec5.monitor.li3':    '<strong>Real-time Data</strong> — Whether each mouse is "struggling" or "immobile", plus optical flow values.',
        'manual.sec5.monitor.li4':    '<strong>System Log</strong> — Terminal-style output with detailed processing info.',
        'manual.sec5.done.title':     'After Analysis Completes',
        'manual.sec5.done.p':         'The download section appears automatically. There are two ways to get results:',
        'manual.sec5.done.li1':       '<strong>Open Result Folder</strong> (recommended) — Click to open the result folder in the system file manager directly.',
        'manual.sec5.done.li2':       '<strong>Web Download</strong> — Click "Download All (ZIP)" to download everything, or pick individual files from the dropdown.',
        'manual.sec5.files.title':    'Output File Reference',
        'manual.sec5.files.th.file':  'File',
        'manual.sec5.files.th.desc':  'Contents',
        'manual.sec5.files.mp4':      'Analysis video with tracking overlays: detected contours, centroid positions, and behavior labels.',
        'manual.sec5.files.logs':     'Frame-by-frame data log. Each row is one frame: frame number, time, ROI ID, struggling flag, optical flow value, etc.',
        'manual.sec5.files.imm':      'Summary statistics table. One row per mouse: total duration, immobility time & percentage, struggling time & percentage, latency to first immobility, etc.',
        'manual.sec5.files.txt':      'Plain-text report with the same content as the CSV above, for easy reading.',
        'manual.sec5.tip':            'If you notice the parameters are wrong mid-analysis, click <strong>"Stop Analysis"</strong> to abort, then return to the home page and start over.',
        'manual.params.title':        'Parameter Reference Table',
        'manual.params.th.param':     'Parameter',
        'manual.params.th.range':     'Range',
        'manual.params.th.tip':       'What to do when unsure',
        'manual.params.gray.tip':     'Drag the slider while watching the preview — stop when the mouse is cleanly detected and the background is clear.',
        'manual.params.bgtype.range': 'Light / Dark',
        'manual.params.bgtype.tip':   'Look at the video background with your eyes and select accordingly.',
        'manual.params.ek.tip':       'Lots of small white noise dots → increase; mouse contour getting incomplete → decrease.',
        'manual.params.ei.tip':       'Noise still can\'t be removed → increase; mouse starting to disappear → decrease.',
        'manual.params.dk.tip':       'Mouse contour has gaps → increase; multiple mice fusing into one detection → decrease.',
        'manual.params.di.tip':       'Gaps still not filled → increase; contour swelling too large → decrease.',
        'manual.params.ma.tip':       'Scattered noise treated as mice → increase; real mouse being filtered out → decrease.',
        'manual.params.tip':          '<strong>Key tip:</strong> After each parameter change, check the preview. Test on multiple frames (drag the slider) — make sure it works across most frames, not just one.',
        'manual.disclaimer.title':    'Disclaimer',
        'manual.disclaimer.p':        'Results provided by this system are for reference only. Accuracy may be affected by lighting conditions, video quality, and individual animal variation. <strong>Researchers must manually verify the results.</strong> The authors are not liable for any data deviation caused by using this system.',
        'manual.disclaimer.academic': 'For academic exchange only. Commercial use prohibited.',
        'manual.disclaimer.author':   'Author: Jiacheng Fu (付家丞)',
        'manual.disclaimer.email':    'Email: 2583348593@qq.com',
        'manual.disclaimer.org':      'Institute of Biophysics, Chinese Academy of Sciences (IBP, CAS)',
    }
};

// ─────────────────────────────────────────
// 核心：读取/写入当前语言
// ─────────────────────────────────────────
function getLang() {
    return localStorage.getItem('mousescope_lang') || 'zh';
}

function setLang(lang) {
    localStorage.setItem('mousescope_lang', lang);
}

// ─────────────────────────────────────────
// 将翻译应用到 DOM
// ─────────────────────────────────────────
function applyLang(lang) {
    const dict = I18N[lang] || I18N['zh'];

    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        const val = dict[key];
        if (val === undefined) return;

        // 区分 placeholder / innerHTML / textContent
        const attr = el.getAttribute('data-i18n-attr');
        if (attr) {
            el.setAttribute(attr, val);
        } else if (el.getAttribute('data-i18n-html') !== null) {
            el.innerHTML = val;
        } else {
            el.textContent = val;
        }
    });

    // 更新 <html lang>
    document.documentElement.lang = (lang === 'zh') ? 'zh-CN' : 'en';
}

// ─────────────────────────────────────────
// 切换语言
// ─────────────────────────────────────────
function toggleLang() {
    const next = (getLang() === 'zh') ? 'en' : 'zh';
    setLang(next);
    applyLang(next);
}

// ─────────────────────────────────────────
// 页面加载时自动应用
// ─────────────────────────────────────────
document.addEventListener('DOMContentLoaded', function () {
    applyLang(getLang());
});
